<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Monitoring Tinggi Muka Air (TMA)</title>

<style>
body{margin:0;font-family:Arial;background:#f2f4f6}
.header{background:#2b86a2;color:#fff;padding:22px 32px;
display:grid;grid-template-columns:1fr 2fr 1fr;align-items:center}
.header-side{display:flex;align-items:center;gap:12px}
.header-right{justify-content:flex-end}
.header-center{text-align:center}
.header-center h1{margin:0;font-size:34px}
.sub{margin-top:6px;font-size:20px}
.logo-left{height:120px}
.logo-right{height:64px}
.container{padding:20px}
.grid{display:grid;grid-template-columns:1.2fr 1fr 1fr;gap:16px}
.card{background:#fff;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,.12)}
.card h2{margin:0;padding:12px 16px;background:#2a87a3;color:#fff}
table{width:100%;border-collapse:collapse}
th,td{padding:10px;border-bottom:1px solid #ddd;font-size:14px}
th{background:#f7f9fb}
.pda-danger{background:#ff2d2d;color:#fff;padding:12px;font-weight:bold}
.pda-alert{background:#ffe066;color:#000;padding:12px;font-weight:bold}
@media(max-width:900px){.grid{grid-template-columns:1fr}}
</style>
</head>

<body>

<div class="header">
  <div class="header-side">
    <img src="https://ayucahyani96.github.io/dashboardTMA/IKN_Nusantara-10.png" class="logo-left">
  </div>
  <div class="header-center">
    <h1 id="judul">Memuat...</h1>
    <div class="sub" id="waktu"></div>
  </div>
  <div class="header-side header-right">
    <img src="https://ayucahyani96.github.io/dashboardTMA/logo_thd.png" class="logo-right">
  </div>
</div>

<div class="container">
  <div class="grid">

    <div class="card">
      <h2>Kondisi TMA</h2>
      <table id="tmaTable"></table>
    </div>

    <div class="card">
      <h2>Status PDA BWS</h2>
      <div id="pdaBahaya" class="pda-danger"></div>
      <table id="pdaBahayaTable"></table>
      <div id="pdaSiaga" class="pda-alert"></div>
      <table id="pdaSiagaTable"></table>
    </div>

    <div class="card">
      <h2>Tindak Lanjut</h2>
      <ul id="tindakList"></ul>
    </div>

  </div>

  <div class="card" style="margin-top:20px">
    <h2>Tren Grafik</h2>
    <div id="grafikTrenContainer" style="padding:16px"></div>
  </div>
</div>

<script>
const API_URL="https://script.google.com/macros/s/AKfycbwR6Nc4_q-cB5VVZf-tycqUBHaD_e6wOUcJMpkIT9tec401B9-lAmV7c9fViX9mq1pd7g/exec";

function loadData(data){
  document.getElementById("judul").innerText=data.meta.judul;
  document.getElementById("waktu").innerText=data.meta.tanggal+" | Pukul "+data.meta.waktu;

  document.getElementById("tmaTable").innerHTML=
    `<tr><th>Lokasi</th><th>TMA</th><th>Tren</th><th>Î”</th><th>Penyebab</th></tr>`+
    data.tma.map(r=>`
      <tr><td>${r.lokasi}</td><td>${r.tma}</td><td>${r.tren}</td><td>${r.perubahan}</td><td>${r.penyebab}</td></tr>`
    ).join("");

  document.getElementById("tindakList").innerHTML=
    data.tindak_lanjut.map(t=>`<li>${t.isi}</li>`).join("");

  const g=document.getElementById("grafikTrenContainer");
  if(data.grafik_tren.length){
    g.innerHTML=data.grafik_tren.map(img=>`
      <img src="${img.url}" style="width:100%;max-height:420px;object-fit:contain;margin-bottom:16px;border-radius:6px">
    `).join("");
  }else{
    g.innerHTML="<i>Grafik tren belum tersedia</i>";
  }
}

// JSONP
const s=document.createElement("script");
s.src=API_URL+"?callback=loadData";
document.body.appendChild(s);
</script>

</body>
</html>
